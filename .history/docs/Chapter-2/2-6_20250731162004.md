## 2.6 贝尔曼方程的矩阵向量形式

$(2.7)$中的贝尔曼方程是元素形式的。由于它对每个状态都有效、我们可以将所有这些方程组合起来，以矩阵向量形式简明地写出、这将经常用于分析贝尔曼方程。

为了得出矩阵向量形式，我们首先将$(2.7)$中的贝尔曼方程重写为

$$v_\pi (s)=r_\pi (s)+\gamma\sum_{s'\in \mathcal{S}}p_\pi(s'|s)v_\pi(s')$$

在这里$r_\pi(s)=\sum_{a\in \mathcal{A}}\pi(a|s)\sum_{r\in \mathcal{R}}p(r|s,a)r,$ $p_\pi(s'|s)=\sum_{a\in \mathcal{A}}\pi(a|s)p(s'|s,a)$

在这里，$r_\pi(s)$)表示即期回报的平均值，$p_\pi(s'|s)$表示在政策$s$下从$s$过渡到$s'$的概率。

假设以$s_i=1,\cdots,n$，$n=|\mathcal{S}|$对状态进行索引，对于状态$s_i$，$(2.8)$可以被写为

$$v_\pi(s_i)=r_\pi(s_i)+\gamma\sum_{s_j\in \mathcal{S}}p_\pi(s_j|s_i)v_\pi(s_j)$$

令$v_\pi=[v_\pi(s_1),\cdots,v_\pi(s_n)]^T\in\mathbb{R}^n,r_\pi=[r_\pi(s_1),\cdots,v\r_\pi(s_n)]^T\in\mathbb{R}^n$

 ![](../img/02/5.png)
 > 演示贝尔曼方程的矩阵向量形式的示例。

